import{u as p,r as l,j as e,s as f}from"./index-CYuisF0z.js";function x(){const{profile:a,profileLoading:r}=p(),[o,t]=l.useState(!1),[n,i]=l.useState(null),u=l.useMemo(()=>{const s=a?.gender==="female"?"Femenino":a?.gender==="male"?"Masculino":"Sin especificar";return[{label:"Nombre",value:a?.firstName??h(a?.fullName)??"—"},{label:"Apellido",value:a?.lastName??v(a?.fullName)??"—"},{label:"Correo",value:a?.email??"—"},{label:"Contraseña",value:"********"},{label:"Género",value:s}]},[a]);l.useEffect(()=>{if(!n)return;const s=window.setTimeout(()=>{i(null)},7e3);return()=>window.clearTimeout(s)},[n]);const m=async()=>{if(!(!a?.email||o))try{t(!0),i({variant:"success",message:"Solicitud enviada al correo, esto puede tardar en llegar en unos minutos. Revisa tu bandeja de entrada o spam."});const s=`${window.location.origin}${window.location.pathname}#/reset-password`,{error:c}=await f.auth.resetPasswordForEmail(a.email,{redirectTo:s});if(c)throw c;i(d=>d?.variant==="success"?d:{variant:"success",message:"Solicitud enviada al correo, esto puede tardar en llegar en unos minutos. Revisa tu bandeja de entrada o spam."})}catch(s){console.error("Error solicitando cambio de contraseña",s),i({variant:"error",message:s?.message??"No pudimos enviar el enlace. Intenta nuevamente en unos minutos."})}finally{t(!1)}};return r?e.jsx("div",{className:"profile-page",children:e.jsx("div",{className:"profile-card",children:e.jsx("p",{className:"profile-loading",children:"Cargando perfil..."})})}):a?e.jsxs("div",{className:"profile-page",children:[e.jsx("header",{className:"profile-header",children:e.jsxs("div",{children:[e.jsx("h1",{children:"Tu información personal"}),e.jsx("p",{children:"Revisa los datos vinculados a tu cuenta. Contacta al administrador si necesitas actualizar alguno."})]})}),e.jsx("section",{className:"profile-card",children:e.jsxs("div",{className:"profile-card-body",children:[e.jsx("dl",{className:"profile-info-grid",children:u.map(s=>e.jsxs("div",{className:"profile-info-item",children:[e.jsx("dt",{children:s.label}),e.jsx("dd",{children:s.value})]},s.label))}),e.jsxs("div",{className:"profile-actions",children:[e.jsxs("div",{className:"profile-actions__content",children:[e.jsx("h2",{children:"¿Necesitas actualizar tu contraseña?"}),e.jsx("p",{children:"Te enviaremos un enlace seguro a tu correo registrado para que elijas una nueva contraseña."}),n?e.jsx("p",{className:`profile-feedback profile-feedback--${n.variant}`,children:n.message}):null]}),e.jsx("button",{type:"button",className:"profile-reset-button",onClick:m,disabled:o||!a?.email,children:o?"Enviando enlace…":"Solicitar cambio de contraseña"})]})]})})]}):e.jsx("div",{className:"profile-page",children:e.jsx("div",{className:"profile-card",children:e.jsx("p",{className:"profile-loading",children:"No pudimos cargar tus datos. Intenta cerrar sesión e iniciar nuevamente."})})})}function h(a){return a?a.split(/\s+/).filter(Boolean)[0]??null:null}function v(a){if(!a)return null;const r=a.split(/\s+/).filter(Boolean);return r.length>1?r[1]:null}export{x as default};
